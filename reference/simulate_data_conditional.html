<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate data which satisfies certain conditions — simulate_data_conditional • simdata</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate data which satisfies certain conditions — simulate_data_conditional"><meta name="description" content="Generate simulated dataset based on transformation of
an underlying base distribution while checking that certain
conditions are met."><meta property="og:description" content="Generate simulated dataset based on transformation of
an underlying base distribution while checking that certain
conditions are met."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">simdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Demo.html">simdata: A package for creating simulated datasets</a></li>
    <li><a class="dropdown-item" href="../articles/NORTA_demo.html">simdata: NORTA based simulation designs</a></li>
    <li><a class="dropdown-item" href="../articles/Technical_documentation.html">simdata: Technical documentation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/matherealize/simdata/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate data which satisfies certain conditions</h1>
      <small class="dont-index">Source: <a href="https://github.com/matherealize/simdata/blob/main/R/simulate_data.R" class="external-link"><code>R/simulate_data.R</code></a></small>
      <div class="d-none name"><code>simulate_data_conditional.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate simulated dataset based on transformation of
an underlying base distribution while checking that certain
conditions are met.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulate_data_conditional</span><span class="op">(</span></span>
<span>  <span class="va">generator</span>,</span>
<span>  n_obs <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  reject <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="cn">TRUE</span>,</span>
<span>  reject_max_iter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  on_reject <span class="op">=</span> <span class="st">"ignore"</span>,</span>
<span>  return_tries <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-generator">generator<a class="anchor" aria-label="anchor" href="#arg-generator"></a></dt>
<dd><p>Function which generates data from the underlying base distribution. It is
assumend it takes the number of simulated observations <code>n_obs</code> as first
argument, as all random generation functions in the <span class="pkg">stats</span> and
<span class="pkg">extraDistr</span> do. Furthermore, it is expected to return a two-dimensional
array as output (matrix or data.frame). See details.</p></dd>


<dt id="arg-n-obs">n_obs<a class="anchor" aria-label="anchor" href="#arg-n-obs"></a></dt>
<dd><p>Number of simulated observations.</p></dd>


<dt id="arg-reject">reject<a class="anchor" aria-label="anchor" href="#arg-reject"></a></dt>
<dd><p>Function which takes a matrix or data.frame <code>X</code> as single input and outputs
TRUE or FALSE. Specifies when a simulated final datamatrix <code>X</code> should
be rejected. Functions must output TRUE if condition IS NOT met / FALSE if
condition IS met and matrix can be accepted. Intended to be used with
<code><a href="function_list.html">function_list</a></code>. See details.</p></dd>


<dt id="arg-reject-max-iter">reject_max_iter<a class="anchor" aria-label="anchor" href="#arg-reject-max-iter"></a></dt>
<dd><p>Integer &gt; 0. In case of rejection, how many times should a new datamatrix be
simulated until the conditions in <code>reject</code> are met?</p></dd>


<dt id="arg-on-reject">on_reject<a class="anchor" aria-label="anchor" href="#arg-on-reject"></a></dt>
<dd><p>If "stop", an error is returned if after <code>reject_max_iter</code> times no
suitable datamatrix X could be found. If "current", the current datamatrix
is returned, regardless of the conditions in <code>reject</code>.
Otherwise, NULL is returned. In each case a warning is reported.</p></dd>


<dt id="arg-return-tries">return_tries<a class="anchor" aria-label="anchor" href="#arg-return-tries"></a></dt>
<dd><p>If TRUE, then the function also outputs the number of tries necessary to
find a dataset fulfilling the condition. Useful to record to assess
the possible bias of the simulated datasets. See Value.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Set random seed to ensure reproducibility of results. See Note below.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>All further parameters are passed to <code><a href="simulate_data.html">simulate_data</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Data.frame or matrix with <code>n_obs</code> rows for simulated dataset <code>X</code> if all
conditions are met within the iteration limit. Otherwise NULL.</p>
<p>If <code>return_tries</code> is TRUE, then the output is a list with the first entry
being the data.frame or matrix as described above, and the second entry
(<code>n_tries</code>) giving a numeric with the number of tries necessary to
find the returned dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For details on generating, transforming and post-processing datasets, see
<code><a href="simulate_data.html">simulate_data</a></code>. This function simulates data conditional
on certain requirements that must be met by the final datamatrix <code>X</code>.
This checking is conducted on the output of <code>simulate_data</code> (i.e.
also includes possible post-processing steps).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Seeding the random number generator is tricky in this case. The seed can not
be passed to <code>simulate_data</code> but is set before calling it, otherwise
the random number generation is the same for each of the tries.
This means that the seed used to call this function might not be the seed
corresponding to the returned dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="rejecting-datasets">Rejecting Datasets<a class="anchor" aria-label="anchor" href="#rejecting-datasets"></a></h2>


<p>Examples for restrictions include
variance restrictions (e.g. no constant columns which could happen due
to extreme transformations of the initial gaussian distribution <code>Z</code>),
ensuring a sufficient number of observations in a given class (e.g. certain
binary variables should have at least x\<!-- % events) or preventing -->
multicollinearity (e.g. <code>X</code> must have full column rank). If <code>reject</code>
evaluates to FALSE, the current datamatrix <code>X</code> is rejected.
In case of rejection, new datasets can be simulated until the conditions
are met or a given maximum iteration limit is hit (<code>reject_max_iter</code>),
after which the latest datamatrix is returned or an error is reported.</p>
    </div>
    <div class="section level2">
    <h2 id="rejection-function">Rejection Function<a class="anchor" aria-label="anchor" href="#rejection-function"></a></h2>


<p>The <code>reject</code> function should take a single input (a data.frame or matrix)
and output TRUE if the dataset is to be rejected or FALSE if it is to be
accepted.
This package provides the <code><a href="function_list.html">function_list</a></code> convenience function
which allows to easily create a rejection function which assesses several
conditions on the input dataset by simply passing individual test functions
to <code>function_list</code>. Such test function templates are found in
<code><a href="is_collinear.html">is_collinear</a></code> and <code><a href="contains_constant.html">contains_constant</a></code>.
See the example below.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="simdesign.html">simdesign</a></code>,
<code><a href="simulate_data.html">simulate_data</a></code>,
<code><a href="function_list.html">function_list</a></code>,
<code><a href="is_collinear.html">is_collinear</a></code>,
<code><a href="contains_constant.html">contains_constant</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dsgn</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdesign_mvtnorm.html">simdesign_mvtnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">simulate_data_conditional</span><span class="op">(</span><span class="va">dsgn</span>, <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    reject <span class="op">=</span> <span class="fu"><a href="function_list.html">function_list</a></span><span class="op">(</span><span class="va">is_collinear</span>, <span class="va">contains_constant</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               v1         v2         v3          v4         v5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.9264592  1.8228212 -1.6105669 -0.28510975 -0.3420730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.3661761 -1.3270408  2.4125922  0.06381535  1.5455148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -1.8847271  0.9114273 -1.3054559  0.04207365 -0.7853306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  1.2116326 -0.9245488 -0.6780290  1.33215937  0.4625876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -1.3022219  1.1084913 -0.7721368 -0.67717026  0.4643073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.9503188 -1.0555950 -0.1178095 -0.25952112 -1.7482390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.9088646  0.2069206  0.3134738  1.16177107 -1.6939916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  1.0352176  0.6658341 -1.2718919  0.60963927  0.8209692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.6948703  2.5308357  0.4522430  0.98874442 -0.1265098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.5149085  0.8279297 -1.3236720 -0.32455266 -0.5578677</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Kammer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

